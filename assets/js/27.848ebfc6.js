(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{441:function(t,a,s){"use strict";s.r(a);var e=s(26),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),s("p",[t._v("一个帮你处理处理异步请求的复用函数 🎉 💯")]),t._v(" "),s("h2",{attrs:{id:"代码演示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码演示"}},[t._v("#")]),t._v(" 代码演示")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("默认请求")]),t._v(" "),s("p",[t._v("在当前例子中，"),s("code",[t._v("useReuqest")]),t._v("接收一个"),s("code",[t._v("service")]),t._v("函数，\n并且通过"),s("code",[t._v("defaultParams")]),t._v("传递了该异步请求函数的参数在组件"),s("code",[t._v("setup")]),t._v("后立即执行，\n"),s("code",[t._v("useReuqest")]),t._v("将接管"),s("code",[t._v("data")]),t._v("、"),s("code",[t._v("loading")]),t._v("、"),s("code",[t._v("error")]),t._v("等相关状态。")])]),t._v(" "),s("request-base"),t._v(" "),s("details",{staticClass:"custom-block details"},[s("summary",[t._v("点击查看代码")]),t._v(" "),s("div",{staticClass:"language-vue extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vue"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-if")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("loading"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("loading...."),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("block"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{ data }}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// import { ref } from '@vue/composition-api'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" service "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../mock'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useRequest "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@xus/vue-reuse'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'request-base'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" loading "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      defaultParams"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'request result'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      loading\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])]),t._v(" "),s("h2",{attrs:{id:"api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  loading"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cancel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  refresh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  reset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  fetches\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useReuqest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n")])])]),s("h4",{attrs:{id:"retrunvalue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#retrunvalue"}},[t._v("#")]),t._v(" RetrunValue")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("类型")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("data")])]),t._v(" "),s("td",[t._v("请求结果")]),t._v(" "),s("td",[s("code",[t._v("Ref<any>")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("loading")])]),t._v(" "),s("td",[t._v("请求状态")]),t._v(" "),s("td",[s("code",[t._v("Ref<Boolean>")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("error")])]),t._v(" "),s("td",[t._v("请求错误状态")]),t._v(" "),s("td",[s("code",[t._v("Ref<null | Error>")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("run")])]),t._v(" "),s("td",[t._v("配置手动执行请求函数时，调用的执行函数")]),t._v(" "),s("td",[s("code",[t._v("function")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("cancel")])]),t._v(" "),s("td",[t._v("配置防抖节流或者轮询时在"),s("code",[t._v("wait")]),t._v("时间到达之前，提供一个取消当前"),s("code",[t._v("run")]),t._v("的方法")]),t._v(" "),s("td",[s("code",[t._v("Ref<function>")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("refresh")])]),t._v(" "),s("td",[t._v("使用最后一次请求参数重新请求")]),t._v(" "),s("td",[s("code",[t._v("Ref<function>")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("reset")])]),t._v(" "),s("td",[t._v("重置当前"),s("code",[t._v("useRequest")]),t._v("声明的请求")]),t._v(" "),s("td",[s("code",[t._v("function")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("fetches")])]),t._v(" "),s("td",[t._v("多个请求并行时对应的请求状态")]),t._v(" "),s("td",[s("code",[t._v("{[fetchKey]: { data, loading, error, cancel, refresh}}")])])])])]),t._v(" "),s("h4",{attrs:{id:"params"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#params"}},[t._v("#")]),t._v(" Params")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("类型")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("service")])]),t._v(" "),s("td",[t._v("请求函数")]),t._v(" "),s("td",[s("code",[t._v("RequestService")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("options")])]),t._v(" "),s("td",[s("code",[t._v("useRequest")]),t._v("配置文件")]),t._v(" "),s("td",[s("code",[t._v("RequestOptions")])])])])]),t._v(" "),s("h4",{attrs:{id:"requestservice"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#requestservice"}},[t._v("#")]),t._v(" RequestService")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("可接受类型")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("(...args: any[]) => Promise<any>")])]),t._v(" "),s("td",[t._v("一般的"),s("code",[t._v("Promise")]),t._v("化请求函数")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("string | { url: string, [key: string]: any }")])]),t._v(" "),s("td",[t._v("需要传递"),s("code",[t._v("requestMethod")]),t._v("配置项，会作为第一个参数传递到"),s("code",[t._v("requestMethod")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("(...args: any[]) => string | { url: string, [key: string]: any }")])]),t._v(" "),s("td",[t._v("需要传递"),s("code",[t._v("requestMethod")]),t._v("配置项，函数返回值会作为第一个参数传递到"),s("code",[t._v("requestMethod")])])])])]),t._v(" "),s("h4",{attrs:{id:"requestoptions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#requestoptions"}},[t._v("#")]),t._v(" RequestOptions")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("配置项")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("类型")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("requestMethod")])]),t._v(" "),s("td",[t._v("请求函数")]),t._v(" "),s("td",[s("code",[t._v("(...args: any[]) => Promise<any>")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("formatResult")])]),t._v(" "),s("td",[t._v("请求结果格式化函数")]),t._v(" "),s("td",[s("code",[t._v("(res: any) => any")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("defaultLoading")])]),t._v(" "),s("td",[t._v("默认加载状态")]),t._v(" "),s("td",[s("code",[t._v("any")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("defaultParams")])]),t._v(" "),s("td",[t._v("默认请求参数")]),t._v(" "),s("td",[s("code",[t._v("any[]")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("defaultData")])]),t._v(" "),s("td",[t._v("默认请求结果")]),t._v(" "),s("td",[s("code",[t._v("any")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("onSuccess")])]),t._v(" "),s("td",[t._v("成功回调")]),t._v(" "),s("td",[s("code",[t._v("(data: any, params: any[]) => void")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("onError")])]),t._v(" "),s("td",[t._v("错误回调")]),t._v(" "),s("td",[s("code",[t._v("(error: Error, params: any[]) => void")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("throwOnError")])]),t._v(" "),s("td",[t._v("请求错误是否对外抛出")]),t._v(" "),s("td",[s("code",[t._v("Boolean")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("manual")])]),t._v(" "),s("td",[t._v("是否手动执行请求")]),t._v(" "),s("td",[s("code",[t._v("Boolean")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("loadingDelay")])]),t._v(" "),s("td",[t._v("加载状态变为"),s("code",[t._v("true")]),t._v("的延迟时长")]),t._v(" "),s("td",[s("code",[t._v("number")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("pollingTime")])]),t._v(" "),s("td",[t._v("轮询间隔时长")]),t._v(" "),s("td",[s("code",[t._v("number")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("debounceTime")])]),t._v(" "),s("td",[t._v("防抖时长")]),t._v(" "),s("td",[s("code",[t._v("number")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("throttleTime")])]),t._v(" "),s("td",[t._v("节流时长")]),t._v(" "),s("td",[s("code",[t._v("number")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("cacheKey")])]),t._v(" "),s("td",[t._v("当前请求硬缓存的键值")]),t._v(" "),s("td",[s("code",[t._v("string")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("cacheTime")])]),t._v(" "),s("td",[t._v("当前请求硬缓存的超时时间")]),t._v(" "),s("td",[s("code",[t._v("number")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("fetchKey")])]),t._v(" "),s("td",[t._v("多请求时对应请求的键值")]),t._v(" "),s("td",[s("code",[t._v("(...args: any[]) => string")])])])])])],1)}),[],!1,null,null,null);a.default=n.exports}}]);